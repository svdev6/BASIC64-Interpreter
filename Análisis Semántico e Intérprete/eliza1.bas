10  REM ELIZA/DOCTOR
20  REM CREATED BY JOSEPH WEIZENBAUM
30  REM THIS VERSION BY JEFF SHRAGER
40  REM EDITED AND MODIFIED FOR MITS 8K BASIC 4.0 BY STEVE NORTH
50  REM CREATIVE COMPUTING PO BOX 789-M MORRISTOWN NJ 07960
60  REM -----INITIALIZATION-----
70  DIM C$(72), I$(72), K$(72), F$(72), S$(72), R$(72), P$(72), Z$(72)
80  DIM S(36), R(36), N(36)
90  LET N1 = 36
92  LET N2 = 12 
98  LET N3 = 112
100 FOR X = 1 TO N1 + N2 + N3 
102 READ Z$ 
104 NEXT X
110 FOR X = 1 TO N1
130 NEXT X
140 PRINT "HI!  I'M ELIZA.  WHAT'S YOUR PROBLEM?"
200 REM USER INPUT SECTION
210 INPUT I$
220 LET I$ = " " + I$ + " "
230 FOR L = 1 TO 5
240 IF MID$(I$, L, 1) = "'" THEN 242
242 LET I$ = LEFT$(I$, L - 1) + RIGHT$(I$, LEN(I$) - L)
243 GOTO 230
244 IF L + 4 <= LEN(I$) THEN 246
246 IF MID$(I$, L, 4) = "SHUT" THEN 248
248 PRINT "SHUT UP..."
250 STOP
260 NEXT L
270 IF I$ = P$ THEN 280
280 PRINT "PLEASE DON'T REPEAT YOURSELF!"
290 GOTO 140

300 REM FIND KEYWORD IN I$
310 S = 0
320 FOR K = 1 TO N1
330   READ K$
340   IF S > 0 THEN GOTO 380
350   FOR L = 1 TO LEN(I$) - LEN(K$) + 1
360     IF MID$(I$, L, LEN(K$)) = K$ THEN 362
362         LET S = K
364         LET T = L
366         LET F$ = K$
370   NEXT L
380 NEXT K
390 IF S > 0 THEN K = S : L = T : GOTO 420
392   LET K = S
394   LET L = T
396   GOTO 420  
400 LET K = 36 
405 GOTO 580

410 REM CONJUGATE THE RIGHT PART OF THE STRING
420 C$ = " " + RIGHT$(I$, LEN(I$) - LEN(F$) - L + 1)
430 FOR X = 1 TO N2 / 2
440   READ S$, R$
450   FOR L = 1 TO LEN(C$)
460     IF L + LEN(S$) > LEN(C$) THEN GOTO 500
470     IF MID$(C$, L, LEN(S$)) = S$ THEN
480       C$ = LEFT$(C$, L - 1) + R$ + RIGHT$(C$, LEN(C$) - L - LEN(S$) + 1)
490       L = L + LEN(R$) - 1
500     END IF
510   NEXT L
520 NEXT X

530 REM GET REPLY USING KEYWORD NUMBER
540 RESTORE : FOR X = 1 TO N1 + N2 : READ Z$ : NEXT X
550 FOR X = 1 TO R(K) : READ F$ : NEXT X
560 R(K) = R(K) + 1
570 IF R(K) > N(K) THEN R(K) = S(K)
580 IF RIGHT$(F$, 1) <> "*" THEN PRINT F$ : P$ = I$ : GOTO 140
590 PRINT LEFT$(F$, LEN(F$) - 1); C$
600 P$ = I$ : GOTO 140

1000 REM PROGRAM DATA
1010 DATA "CAN YOU", "CAN I", "YOU ARE", "YOURE", "I DONT", "I FEEL"
1020 DATA "WHY DONT YOU", "WHY CANT I", "ARE YOU", "I CANT", "I AM", "IM "
1030 DATA "YOU", "I WANT", "WHAT", "HOW", "WHO", "WHERE", "WHEN", "WHY"
1040 DATA "NAME", "CAUSE", "SORRY", "DREAM", "HELLO", "HI", "MAYBE"
1050 DATA "NO", "YOUR", "ALWAYS", "THINK", "ALIKE", "YES", "FRIEND"
1060 DATA "COMPUTER", "NOKEYFOUND"
1070 DATA 1, 3, 4, 2, 6, 4, 6, 4, 10, 4, 14, 3, 17, 3, 20, 2, 22, 3
1080 DATA 25, 3, 28, 4, 32, 3, 35, 5, 40, 9, 40, 9, 40, 9, 40, 9, 40, 9, 40, 9
